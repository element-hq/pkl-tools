//
// Copyright 2025 New Vector Ltd.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//

amends "pkl:test"

import "../StaticCode.pkl"

import "../examples/SampleConfiguration.pkl"
import "../examples/SimpleModule.pkl"
import "../examples/RepeatedTypes.pkl"
import "../examples/NullableValues.pkl"
import "../examples/ModuleTypes.pkl"

examples {
  ["Swift Renderer"] {
    SampleConfiguration.output.text
  }
  ["Kotlin Renderer"] {
    (SampleConfiguration) { output { renderer = makeKotlinRenderer("TestConfiguration") } }.output.text
  }

  ["Swift Simple Module"] {
    SimpleModule.output.text
  }
  ["Kotlin Simple Module"] {
    (SimpleModule) { output { renderer = makeKotlinRenderer("TestModule") } }.output.text
  }

  ["Swift Repeated Types"] {
    RepeatedTypes.output.text
  }
  ["Kotlin Repeated Types"] {
    (RepeatedTypes) { output { renderer = makeKotlinRenderer("TestTypes") } }.output.text
  }

  ["Swift Nullable Values"] {
    NullableValues.output.text
  }
  ["Kotlin Nullable Values"] {
    (NullableValues) { output { renderer = makeKotlinRenderer("NullableTypes") } }.output.text
  }

  ["Swift Module Types"] {
    ModuleTypes.output.text
  }
  ["Kotlin Module Types"] {
    (ModuleTypes) { output { renderer = makeKotlinRenderer("ModuleTypes") } }.output.text
  }
}

local function makeKotlinRenderer(_objectName: String) =
  new StaticCode.Renderer {
    language = "Kotlin"
    packageName = "my.package"
    objectName = _objectName
  }